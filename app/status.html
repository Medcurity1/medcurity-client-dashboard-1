<!doctype html><html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>Client Status</title><link rel='stylesheet' href='/styles.css'></head><body><main><div class='card'><h1 id='name'>Client Status</h1><p id='meta' class='muted'></p><div id='details' class='grid'></div></div><div class='card'><h2>Metrics</h2><table class='table' id='tbl'><thead><tr><th>Field</th><th>Value</th></tr></thead><tbody></tbody></table></div></main><script>
const q=new URLSearchParams(location.search);const sf=q.get('sf_id')||'';const sig=q.get('sig')||'';if(!sf||!sig){document.body.innerHTML='<main><div class=card><h2>Missing sf_id or sig.</h2></div></main>';}else{fetch(`/api/status?sf_id=${encodeURIComponent(sf)}&sig=${encodeURIComponent(sig)}`).then(r=>r.json()).then(d=>{document.getElementById('name').textContent=d.task_name||'Client Dashboard';document.getElementById('meta').textContent=`SF ID: ${d.sf_id} | Status: ${d.task_status} | Updated: ${d.source_updated_at||''}`;const det=document.getElementById('details');[['Project Lead',d.metrics?.['project.project_lead']||'Not assigned'],['Project Support',d.metrics?.['project.project_support']||'Not assigned'],['Location',d.metrics?.['project.remote_onsite']||'Not set']].forEach(([k,v])=>{const el=document.createElement('div');el.className='metric';el.innerHTML=`<div class='muted'>${k}</div><div>${v||'Not set'}</div>`;det.appendChild(el);});const tb=document.querySelector('#tbl tbody');Object.entries(d.metrics||{}).sort((a,b)=>a[0].localeCompare(b[0])).forEach(([k,v])=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${k}</td><td>${v||''}</td>`;tb.appendChild(tr);});}).catch(e=>{document.body.innerHTML='<main><div class=card><h2>Load failed</h2><p>'+String(e)+'</p></div></main>'});}
</script></body></html>
