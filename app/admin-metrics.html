<!doctype html><html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>Admin Metrics</title><link rel='stylesheet' href='/styles.css'></head><body><main><div class='card'><h1>Admin Metrics</h1><p><a id='projectsLink' href='/admin/projects'>Projects</a></p><div class='grid' id='top'></div></div><div class='card'><h2>Quarterly</h2><table class='table' id='tbl'><thead><tr><th>Quarter</th><th>Closures</th><th>Avg Close Days</th></tr></thead><tbody></tbody></table></div></main><script>
const q=new URLSearchParams(location.search);const key=q.get('key')||'';document.getElementById('projectsLink').href='/admin/projects?key='+encodeURIComponent(key);fetch(`/api/admin/metrics?key=${encodeURIComponent(key)}`).then(r=>r.json()).then(d=>{document.getElementById('top').innerHTML=`<div class='metric'><div class='muted'>Tracked Closures</div><div>${d.total_tracked_closures||0}</div></div><div class='metric'><div class='muted'>Avg Close Days</div><div>${d.avg_close_days||0}</div></div>`;const tb=document.querySelector('#tbl tbody');(d.quarters||[]).forEach(x=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${x.quarter}</td><td>${x.count}</td><td>${x.avg_close_days}</td>`;tb.appendChild(tr);});}).catch(e=>{document.body.innerHTML='<main><div class=card><h2>Load failed</h2><p>'+String(e)+'</p></div></main>'});
</script></body></html>
